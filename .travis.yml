language: c

os: linux-ppc64le

sudo: required

services: docker

branches:
    only:
    - coverity_scan
    - master

env:

    matrix:
    - RUN_ON_CONTAINER=fedora-rawhide

addons:
    
    coverity_scan:
	
    project:
	
       name: anupkumk/servicelog
	
       #version: 1.0
      	
       description: servicelog
    
       # Where email notification of build analysis results will be sent
    
       #notification_email: scan_notifications@example.com
    
       # Commands to prepare for build_command
    
       # ** likely specific to your build **
    
       #build_command_prepend: ./configure
    
       # The command that will be added as an argument to "cov-build" to compile your project for analysis,
    
       # ** likely specific to your build **
    
       build_command: make
    
       # Pattern to match selecting branches that will run analysis. We recommend leaving this set to 'coverity_scan'.
    
       # Take care in resource usage, and consider the build frequency allowances per
    
       #   https://scan.coverity.com/faq#frequency
    
       branch_pattern: coverity_scan

script:
    - docker build --pull -t ${RUN_ON_CONTAINER} -f servicelog-ci/Dockerfile-${RUN_ON_CONTAINER} . &&
      docker run --volume $HOME/.ccache:/root/.ccache --volume `pwd`:/build --rm -t $RUN_ON_CONTAINER bash -c "./servicelog-ci/build-${RUN_ON_CONTAINER}.sh";
