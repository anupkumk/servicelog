language: c

os: linux

arch: ppc64le

sudo: required

services: docker
        
branches:
    only:
    - coverity_scan
    - master

env:

    matrix:
    - RUN_ON_CONTAINER=fedora-rawhide

addons:
    
    coverity_scan:
            
            project:
                    
            name: anupkumk/servicelog
            
            description: servicelog
            
            build_command: make
            
            # Pattern to match selecting branches that will run analysis. We recommend leaving this set to 'coverity_scan'.

            # Take care in resource usage, and consider the build frequency allowances per
            
            # https://scan.coverity.com/faq#frequency

            branch_pattern: coverity_scan

script:
    - docker build --pull -t ${RUN_ON_CONTAINER} -f servicelog-ci/Dockerfile-${RUN_ON_CONTAINER} . &&
      docker run --volume $HOME/.ccache:/root/.ccache --volume `pwd`:/build --rm -t $RUN_ON_CONTAINER bash -c "./servicelog-ci/build-${RUN_ON_CONTAINER}.sh";
